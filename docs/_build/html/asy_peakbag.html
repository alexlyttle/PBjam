
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>asy_peakbag &#8212; PBjam 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="peakbag" href="peakbag.html" />
    <link rel="prev" title="star" href="star.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-pbjam.asy_peakbag">
<span id="asy-peakbag"></span><h1>asy_peakbag<a class="headerlink" href="#module-pbjam.asy_peakbag" title="Permalink to this headline">¶</a></h1>
<p>Fitting asymptotic relation to an SNR spectrum</p>
<p>This module fits the asymptotic relation to the p-modes in a frequency range
around nu_max in a solar-like oscillator. Only l=0 and l=2 are fit, l=1 modes
are ignored.</p>
<dl class="function">
<dt id="pbjam.asy_peakbag.P_envelope">
<code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">P_envelope</code><span class="sig-paren">(</span><em>nu</em>, <em>hmax</em>, <em>numax</em>, <em>width</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#P_envelope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.P_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Power of the p-mode envelope</p>
<p>Computes the power at frequency nu in the p-mode envelope from a Gaussian
distribution. Used for computing mode heights</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency (muHz).</li>
<li><strong>hmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Height of p-mode envelope (SNR).</li>
<li><strong>numax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency of maximum power of the p-mode envelope (muHz).</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Width of the p-mode envelope (muHz).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>h</strong> – Power at frequency nu (SNR)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="pbjam.asy_peakbag.Prior">
<em class="property">class </em><code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">Prior</code><span class="sig-paren">(</span><em>bounds</em>, <em>gaussian</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#Prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.Prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the proirs on the provided model parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bounds</strong> (<em>array</em>) – Numpy array of upper and lower boundaries for the asymptotic relation
fit. These limits truncate the likelihood function.</li>
<li><strong>gaussian</strong> (<em>array</em>) – Numpy array of tuples of mean and sigma for Gaussian
priors on each of the fit parameters (To be removed when full
KDE is implimented)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pbjam.asy_peakbag.Prior.data_file">
<code class="descname">data_file</code><a class="headerlink" href="#pbjam.asy_peakbag.Prior.data_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Pathname to the file containing stellar parameters to make the KDE
prior.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.Prior.prior_data">
<code class="descname">prior_data</code><a class="headerlink" href="#pbjam.asy_peakbag.Prior.prior_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Dataframe with all the prior data. Read from prior_data.csv.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">pandas.DataFrame instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.Prior.kde">
<code class="descname">kde</code><a class="headerlink" href="#pbjam.asy_peakbag.Prior.kde" title="Permalink to this definition">¶</a></dt>
<dd><p>KDE based on the prior data file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">sm.nonparametric.KDEMultivariate instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.Prior.pbound">
<code class="descname">pbound</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#Prior.pbound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.Prior.pbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if parameter set is out of bounds</p>
<p>Truncates posterior beyond the supplied bounds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p</strong> (<em>array</em>) – Array containing model parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>prior</strong> – If within bounds returns 0, -inf if not</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or inf</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.Prior.pgaussian">
<code class="descname">pgaussian</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#Prior.pgaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.Prior.pgaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Guassian priors</p>
<p>Function for setting Gaussian priors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p</strong> (<em>array</em>) – Array containing mcmc proposals</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprior</strong> – Sum of Guassian priors evaluted at respective values of p</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pbjam.asy_peakbag.asymp_spec_model">
<em class="property">class </em><code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">asymp_spec_model</code><span class="sig-paren">(</span><em>f</em>, <em>norders</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymp_spec_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymp_spec_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for spectrum model using asymptotic relation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>array</em>) – Array of frequency bins of the spectrum (muHz). Truncated to the range
around numax.</li>
<li><strong>norders</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of radial order to fit</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymp_spec_model.f">
<code class="descname">f</code><a class="headerlink" href="#pbjam.asy_peakbag.asymp_spec_model.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of frequency bins of the spectrum (muHz). Truncated to the range
around numax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a>, array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymp_spec_model.norders">
<code class="descname">norders</code><a class="headerlink" href="#pbjam.asy_peakbag.asymp_spec_model.norders" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of radial order to fit</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.asymp_spec_model.lor">
<code class="descname">lor</code><span class="sig-paren">(</span><em>freq</em>, <em>h</em>, <em>w</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymp_spec_model.lor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymp_spec_model.lor" title="Permalink to this definition">¶</a></dt>
<dd><p>Lorentzian to describe a mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>freq</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency of lorentzian (muHz)</li>
<li><strong>h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Height of the lorentizan (SNR)</li>
<li><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Full width of the lorentzian (log10(muHz))</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mode</strong> – The SNR as a function frequency for a lorentzian</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.asymp_spec_model.model">
<code class="descname">model</code><span class="sig-paren">(</span><em>dnu</em>, <em>numax</em>, <em>eps</em>, <em>d02</em>, <em>alpha</em>, <em>hmax</em>, <em>envwidth</em>, <em>modewidth</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymp_spec_model.model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymp_spec_model.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a spectrum model from the asymptotic relation</p>
<p>The asymptotic relation for p-modes with angular degree, l=0, is
defined as:
nu_nl = (n + epsilon + alpha/2(n - nmax)**2) * log_dnu,</p>
<p>where nmax = numax / dnu - eps.</p>
<p>We separate the l=0 and l=2 modes by d02.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>numax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency of maximum power of the p-mode envelope (muHz)</li>
<li><strong>dnu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Large separation (muHz)</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Phase term of the asymptotic relation (unitless)</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Curvature of the asymptotic relation (unitless)</li>
<li><strong>d02</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Small separation (muHz)</li>
<li><strong>hmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Gaussian height of p-mode envelope (SNR)</li>
<li><strong>envwidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Gaussian width of the p-mode envelope (muHz)</li>
<li><strong>modewidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Width of the modes (log10(muHz))</li>
<li><strong>*args</strong> (<em>array-like</em>) – List of additional parameters (Teff, bp_rp) that aren’t actually
used to construct the spectrum model, but just for evaluating the
prior.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>model</strong> – spectrum model around the p-mode envelope</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.asymp_spec_model.pair">
<code class="descname">pair</code><span class="sig-paren">(</span><em>freq0</em>, <em>h</em>, <em>w</em>, <em>d02</em>, <em>hfac=0.7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymp_spec_model.pair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymp_spec_model.pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a pair as the sum of two Lorentzians</p>
<p>A pair is assumed to consist of an l=0 and an l=2 mode. The widths are
assumed to be identical, and the height of the l=2 mode is scaled
relative to that of the l=0 mode. The frequency of the l=2 mode is the
l=0 frequency minus the small separation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>freq0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency of the l=0 (muHz)</li>
<li><strong>h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Height of the l=0 (SNR)</li>
<li><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The mode width (identical for l=2 and l=0) (log10(muHz))</li>
<li><strong>d02</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The small separation (muHz)</li>
<li><strong>hfac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Ratio of the l=2 height to that of l=0 (unitless)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pair_model</strong> – The SNR as a function of frequency of a mode pair.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pbjam.asy_peakbag.asymptotic_fit">
<em class="property">class </em><code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">asymptotic_fit</code><span class="sig-paren">(</span><em>f</em>, <em>snr</em>, <em>start_samples</em>, <em>teff</em>, <em>bp_rp</em>, <em>store_chains=True</em>, <em>nthreads=1</em>, <em>norders=8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymptotic_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for fitting a spectrum based on the asymptotic relation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>- don't pass star pass attributes ... star</strong> (<em>TODO</em>) – Star class instance to perform the fit on. This contains the required
attributes for the fit, f, s, numax, dnu, teff. All others are derived
from these, or can optionally be set.</li>
<li><strong>teff</strong> – TODO</li>
<li><strong>bp_rp</strong> – TODO</li>
<li><strong>store_chains</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Flag for storing all the full set of samples from the MCMC run.
Warning, if running multiple targets, make sure you have enough memory.</li>
<li><strong>nthreads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of multiprocessing threads to use to perform the fit. For long
cadence data 1 is best, more will just add parallelization overhead.
Untested on short cadence.</li>
<li><strong>norders</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of radial orders to fit</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymptotic_fit.f">
<code class="descname">f</code><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of frequency bins of the spectrum (muHz).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymptotic_fit.s">
<code class="descname">s</code><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.s" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of power in each frequency bin (SNR).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymptotic_fit.sel">
<code class="descname">sel</code><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.sel" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of boolean values specifying the frequency range to be
considered in the asymptotic relation fit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymptotic_fit.model">
<code class="descname">model</code><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for computing a spectrum model given a set of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">asy_peakbag.model.model instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymptotic_fit.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of upper and lower boundaries for the asymptotic relation
fit. These limits truncate the likelihood function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.asymptotic_fit.gaussian">
<code class="descname">gaussian</code><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of tuples of mean and sigma for Gaussian
priors on each of the fit parameters (To be removed when full
KDE is implimented).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.asymptotic_fit.get_modeIDs">
<code class="descname">get_modeIDs</code><span class="sig-paren">(</span><em>fit</em>, <em>N</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymptotic_fit.get_modeIDs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.get_modeIDs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set mode ID in a dataframe</p>
<p>Evaluates the asymptotic relation for each walker position from the
MCMC fit. The median values of the resulting set of frequencies are
then returned in a pandas.DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fit</strong> (<em>asy_peakbag.mcmc class instance</em>) – mcmc class instances used in the fit</li>
<li><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of radial orders to output. Note that doesn’t have to be
the same as that used int he fit itself.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>modeID</strong> – Dataframe of radial order, n (best guess), angular degree, l,
frequency and frequency error.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.asymptotic_fit.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>burnin=1000</em>, <em>niter=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymptotic_fit.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup, run and parse the asymptotic relation fit using EMCEE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>modeID</strong> – Dataframe of radial order, n (best guess), angular degree, l,
frequency and frequency error.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.asymptotic_fit.set_bounds">
<code class="descname">set_bounds</code><span class="sig-paren">(</span><em>start</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymptotic_fit.set_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.set_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameter bounds for asymptotic relation fit</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>start</strong> (<em>arraylike</em>) – <dl class="docutils">
<dt>Note:[‘dnu’, ‘numax’, ‘eps’,</dt>
<dd>’d02’, ‘alpha’, ‘env_height’,
‘env_width’, ‘mode_width’, ‘teff’,
‘bp_rp’]</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>bounds</strong> (<em>array</em>) – Numpy array of upper and lower boundaries for the asymptotic relation
fit. These limits truncate the likelihood function.</li>
<li><em>[‘dnu’, ‘numax’, ‘eps’,</em> – ‘d02’, ‘alpha’, ‘env_height’,
‘env_width’, ‘mode_width’, ‘teff’,
‘bp_rp’]</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.asymptotic_fit.set_gaussian_pars">
<code class="descname">set_gaussian_pars</code><span class="sig-paren">(</span><em>teff</em>, <em>bp_rp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymptotic_fit.set_gaussian_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_fit.set_gaussian_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of the Gaussian priors</p>
<p>Used to define the mean and standard deviation of the Gaussian priors
on each of the parameters.</p>
<p>This will be deprecated in forthcoming versions of PBjam. To be
replaced by a full KDE on all fit parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>gaussian</strong> – Numpy array of tuples of mean and sigma for Gaussian
priors on each of the fit parameters (To be removed when full
KDE is implimented).</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pbjam.asy_peakbag.asymptotic_relation">
<code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">asymptotic_relation</code><span class="sig-paren">(</span><em>numax</em>, <em>dnu</em>, <em>eps</em>, <em>alpha</em>, <em>norders</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#asymptotic_relation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.asymptotic_relation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the l=0 mode frequencies from the asymptotic relation for
p-modes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>numax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency of maximum power of the p-mode envelope (muHz).</li>
<li><strong>dnu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Large separation of l=0 modes (muHz).</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Epsilon phase term in asymptotic relation (unitless).</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Curvature factor of l=0 ridge (second order term, unitless).</li>
<li><strong>norders</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of desired radial orders to calculate frequncies for, centered
around numax.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>nu0s</strong> – Array of l=0 mode frequencies from the asymptotic relation (muHz).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array()</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pbjam.asy_peakbag.get_enns">
<code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">get_enns</code><span class="sig-paren">(</span><em>nmax</em>, <em>norders</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#get_enns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.get_enns" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute radial order numbers.</p>
<p>Get the enns that will be included in the asymptotic relation fit. These
are all integer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency of maximum power of the p-mode envelope</li>
<li><strong>norders</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Total number of radial orders to consider</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>enns</strong> – Numpy array of norders radial orders (integers) around numax (nmax).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pbjam.asy_peakbag.get_nmax">
<code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">get_nmax</code><span class="sig-paren">(</span><em>numax</em>, <em>dnu</em>, <em>eps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#get_nmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.get_nmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute radial order at numax.</p>
<p>Compute the radial order at numax, which in this implimentation of the
asymptotic relation is not necessarily integer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>numax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frequency of maximum power of the p-mode envelope (muHz).</li>
<li><strong>dnu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Large separation of l=0 modes (muHz).</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Epsilon phase term in asymptotic relation (muHz).</li>
<li><strong>Returns</strong> – <dl class="docutils">
<dt>nmax <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>non-integer radial order of maximum power of the p-mode envelope</dd>
</dl>
</li>
<li><strong>-------</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pbjam.asy_peakbag.get_summary_stats">
<code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">get_summary_stats</code><span class="sig-paren">(</span><em>fit</em>, <em>model</em>, <em>pnames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#get_summary_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.get_summary_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Make dataframe with fit summary statistics</p>
<p>Creates a dataframe that contains various quantities that summarize the
fit. Note, these are predominantly derived from the marginalized posteriors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fit</strong> (<em>asy_peakbag.mcmc instance</em>) – asy_peakbag.mcmc that was used to fit the spectrum, containing the
log-likelihoods and MCMC chains.</li>
<li><strong>model</strong> (<em>the asymp_spec_model.model instance that defines the model used to</em>) – fit the spectrum.</li>
<li><strong>pnames</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of names of each of the parameters in the fit.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>summary</strong> (<em>pandas.DataFrame</em>) – Dataframe with the summary statistics.</li>
<li><strong>mle_model</strong> (<em>1d array</em>) – Numpy array with the model spectrum corresponding to the maximum
likelihood solution.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pbjam.asy_peakbag.mad">
<code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">mad</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em>, <em>scale=1.4826</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#mad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.mad" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute median absolute deviation</p>
<p>Grabbed from Scipy version 1.3.0.</p>
<p>TODO - To be removed once PBjam works with Scipy v &gt; 1.2.0 and replaced
with scipy.stats.median_absolute_deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array</em>) – Array to compute the mad for.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Axis to compute the mad over</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Scale factor for the MAD, 1.4826 to match standard deviation for
Gaussian.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mad</strong> – The median absolute deviation(s) of the array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="pbjam.asy_peakbag.mcmc">
<em class="property">class </em><code class="descclassname">pbjam.asy_peakbag.</code><code class="descname">mcmc</code><span class="sig-paren">(</span><em>f</em>, <em>s</em>, <em>model</em>, <em>start</em>, <em>lp</em>, <em>nthreads=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#mcmc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.mcmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for MCMC sampling</p>
<p>Use EMCEE to fit a provided model to a spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>array</em>) – Array of frequency bins of the spectrum (muHz)</li>
<li><strong>s</strong> (<em>array</em>) – The power at frequencies f</li>
<li><strong>model</strong> (<em>asy_peakbag.model.model instance</em>) – Function for computing a spectrum model given a set of parameters.</li>
<li><strong>pars_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of parameter names in the asymptotic fit</li>
<li><strong>guess</strong> (<em>dictionary</em>) – Dictionary for organizing the initial guess for the asymptotic fir
parameters.</li>
<li><strong>bounds</strong> (<em>array</em>) – Numpy array of upper and lower boundaries for the asymptotic relation
fit. These limits truncate the likelihood function.</li>
<li><strong>gaussian</strong> (<em>array</em>) – Numpy array of tuples of mean and sigma for Gaussian
priors on each of the fit parameters (To be removed when full
KDE is implimented)</li>
<li><strong>nthreads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of multiprocessing threads to use to perform the fit. For long
cadence data 1 is best, more will just add parallelization overhead.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.ndim">
<code class="descname">ndim</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of fit variables</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.lp">
<code class="descname">lp</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.lp" title="Permalink to this definition">¶</a></dt>
<dd><p>Prior class initialized using model parameter limits, Gaussian
paramaters, and the KDE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Prior class instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.burnin">
<code class="descname">burnin</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.burnin" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of steps to take as the burn-in phase. These are discarded at
the end of the MCMC run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.niter">
<code class="descname">niter</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.niter" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of steps to take after the burn-in phase. These will be tested
for convergence. Once the test is satisfied these steps will will be
assumed to be samples of the posterior distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.nwalkers">
<code class="descname">nwalkers</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.nwalkers" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of walkers to use in the MCMC fit</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.prior_only">
<code class="descname">prior_only</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.prior_only" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for whether or not to just sample the prior, or to sample both
sum of the prior and likelihood function. Use to draw initial positions
for the walkers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.chain">
<code class="descname">chain</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of shape (niter, nwalkers, ndim) with all the MCMC samples
drawn after the burn-in phase.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.flatchain">
<code class="descname">flatchain</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.flatchain" title="Permalink to this definition">¶</a></dt>
<dd><p>A flattened version of the chain array of shape (niter*nwalkers, ndim).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.lnlike">
<code class="descname">lnlike</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of shape (niter, nwalkers) of the likelihood at each step
of each walker.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pbjam.asy_peakbag.mcmc.flatlnlike">
<code class="descname">flatlnlike</code><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.flatlnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>A flattened version of the lnlike array of shape (niter*walkers)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.mcmc.convergence_test">
<code class="descname">convergence_test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#mcmc.convergence_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.convergence_test" title="Permalink to this definition">¶</a></dt>
<dd><p>TBD</p>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.mcmc.fold">
<code class="descname">fold</code><span class="sig-paren">(</span><em>sampler</em>, <em>pos</em>, <em>spread</em>, <em>accept_lim=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#mcmc.fold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.fold" title="Permalink to this definition">¶</a></dt>
<dd><p>Fold low acceptance walkers into main distribution</p>
<p>At the end of the burn-in, some walkers appear stuck with low
acceptance fraction. These can be selected using a threshold, and
folded back into the main distribution, estimated based on the median
of the walkers with an acceptance fraction above the threshold.</p>
<p>The stuck walkers are relocated with multivariate Gaussian, with mean
equal to the median of the high acceptancew walkers, and a standard
deviation equal to the median absolute deviation of these, with a
small scaling factor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sampler</strong> (<em>emcee sampler object</em>) – The sampler used in the fit</li>
<li><strong>pos</strong> (<em>array</em>) – The final position of the walkers after the burn-in phase</li>
<li><strong>spread</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The factor to apply to the walkers that are adjusted</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pbjam.asy_peakbag.mcmc.likelihood">
<code class="descname">likelihood</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pbjam/asy_peakbag.html#mcmc.likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pbjam.asy_peakbag.mcmc.likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Likelihood function for set of model parameters</p>
<p>Evaluates the likelihood function and applies any priors for a set of
model parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p</strong> (<em>array</em>) – Array of model parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>like</strong> – likelihood function at p</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PBjam</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help &amp; Contact</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="api.html">API</a><ul>
      <li>Previous: <a href="star.html" title="previous chapter">star</a></li>
      <li>Next: <a href="peakbag.html" title="next chapter">peakbag</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Martin Nielsen.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/asy_peakbag.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>